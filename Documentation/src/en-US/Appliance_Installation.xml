<?xml version='1.0'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>

<chapter id="chap-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation">
	<title>Stand-alone oVirt Appliance installation</title>
	<para>
		This chapter covers the steps required to get the oVirt Server Suite Appliance installed and running on a stand-alone machine.
	</para>
	<para>
		There are two types of oVirt Server Suite installation:
		<itemizedlist>
			<listitem>
				<para>
					Stand-alone oVirt Appliance. The stand-alone oVirt Appliance runs from a single machine, it can be expanded later and is suitable for testing and development.
				</para>
			</listitem>
			<listitem>
				<para>
					oVirt Appliance with Managed Nodes. The oVirt Appliance with Managed Nodes is made up of the oVirt Appliance and dedicated, Managed Nodes. This installation setup fully utilizes the potential of oVirt in providing manageability and scalability. Managed Nodes require additional hardware. For information on installing the oVirt Appliance with Managed Nodes refer to <xref linkend="chap-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics" />.
				</para>
			</listitem>
		</itemizedlist>
	</para>
	<para>
		The advanced installation topics chapter(<xref linkend="chap-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics" />) also covers how to integrate individual oVirt components.
	</para>
	<section id="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_oVirt_Appliance">
		<title>Installing oVirt Appliance</title>
		<para>
			This section describes how to install the stand-alone version of the oVirt Appliance. Installing the developer version is the fastest way to get oVirt up and running because it is intended to help you to start using oVirt and become familiar with the user interface. The developer version of the oVirt appliance cannot be used to manage physical hosts. To manage physical hosts, you must install the bundled version of the appliance, using the instructions in <xref linkend="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_oVirt_on_a_Physical_Network" />.
		</para>
		<section id="sect-oVirt_Installation_Guide-Installing_oVirt_Appliance-Installing_the_Appliance_from_the_oVirt_website">
			<title>Installing the Appliance from the oVirt website</title>
			<para>
				This section describes how to install the developer version using the pre-built appliance provided on the oVirt website download page.
			</para>
			<orderedlist>
				<listitem>
					<para>
						Download the <ulink url="http://ovirt.org/download/ovirt-developer-appliance-0.91-1-x86_64.tar"> appliance</ulink> script onto the host machine.
					</para>
				</listitem>
				<listitem>
					<para>
						Extract the image to <filename>/var/lib/libvirt/images/</filename>:
<screen># cd /var/lib/libvirt/images; tar jxf ovirt-developer-appliance-0.91-1-*.tar;
# mv ovirt-developer-appliance-*/developer.img /var/lib/libvirt/images</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						Run <filename>create-wui-appliance.sh</filename> to create the virtual machine.
<screen># bash ovirt-developer-appliance-*/create-wui-appliance.sh -v</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						Remove the list of known hosts:
<screen>#rm -Rf ~/.ssh/known_hosts</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						Start the virtual machine named <filename>developer</filename>.
<screen>virsh start developer</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						Start up some fake managed nodes. These are additional KVM guests on the same host machine, but they act as if they were separate physical nodes. You can use up to 3 fake managed nodes, named node3, node4, and node5. To start the nodes:
<screen># virsh start node3
# virsh start node4</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						Invoke the main oVirt page by running Firefox on the guest.
<screen># ssh -Y root@192.168.50.2 firefox</screen>
						 Enter the root password: <code>ovirt</code>
					</para>
					<para>
						A browser window opens displaying the oVirt User Administration Interface.
					</para>
				</listitem>
				<listitem>
					<para>
						To connect to the console of a virtual machine running on a managed node:
<screen># ssh -Y root@192.168.50.2 virt-viewer -c qemu+tcp://node3.priv.ovirt.org/system VM_NAME</screen>
					</para>
				</listitem>
			</orderedlist>
			<note>
				<title>Note</title>
				<para>
					The kickstart can be copied to a local webserver and modified so that the repos referenced in the kickstart point to local mirrors. In this case, the command is:
<screen>
# create-wui-appliance.sh -t http://foo/f9-x86_64 -k http://foo/wui-rel-x86_64.ks -v</screen>
				</para>
			</note>
		</section>

	</section>

	<section id="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_oVirt_on_a_Physical_Network">
		<title>Installing oVirt on a Physical Network</title>
		<para>
			Set up the bundled oVirt appliance if you wish to manage physical hosts. This version allows you to manage physical hardware. It requires a minimum of 2 machines and a separately cabled network.
		</para>
		<note>
			<title>Note</title>
			<para>
				You must be the root user to perform the installation.
			</para>
		</note>
		<section id="sect-oVirt_Installation_Guide-Installing_oVirt_on_a_Physical_Network-Setting_up_the_Hardware">
			<title>Setting up the Hardware</title>
			<para>
				This section describes how to set up the hardware for a simple bundled oVirt installation.
			</para>
			<orderedlist>
				<listitem>
					<para>
						Set up the management node to enable it to run the management console as a KVM guest, and take over the second network card (eth1) for a private oVirt network.
					</para>
				</listitem>
				<listitem>
					<para>
						Set up the managed nodes. Connect the managed nodes to the same network as the second network interface on the management host.
					</para>
				</listitem>
				<listitem>
					<para>
						Set up the private network. This step is fully automated by <command>create-wui-appliance.sh</command>.
					</para>
				</listitem>
				<listitem>
					<para>
						Set up storage.
					</para>
				</listitem>
			</orderedlist>
		</section>

	</section>

	<section id="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_the_Appliance">
		<title>Installing the Appliance</title>
		<para>
			This section describes how to install the pre-built appliance from the oVirt website download page to manage physical hardware.
		</para>
		<orderedlist>
			<listitem>
				<para>
					Download the <ulink url="http://ovirt.org/download/ovirt-developer-appliance-0.91-1-x86_64.tar">appliance</ulink> script onto the host machine.
				</para>
			</listitem>
			<listitem>
				<para>
					Extract the image to <filename>/var/lib/libvirt/images/</filename>:
<screen># cd /var/lib/libvirt/images; tar jxf ovirt-developer-appliance-0.91-1-*.tar; \
mv ovirt-developer-appliance-*/developer.img /var/lib/libvirt/images</screen>
				</para>
			</listitem>
			<listitem>
				<para>
					Run <filename>create-wui-appliance.sh</filename> to create the virtual machine.
<screen># bash ovirt-developer-appliance-*/create-wui-appliance.sh -b</screen>
				</para>
			</listitem>
			<listitem>
				<para>
					Remove the list of known hosts:
<screen>#rm -Rf ~/.ssh/known_hosts</screen>
				</para>
			</listitem>
			<listitem>
				<para>
					Start the virtual machine named <filename>developer</filename>.
<screen>virsh start developer</screen>
				</para>
			</listitem>
			<listitem>
				<para>
					Start up some managed nodes.
<screen># virsh start node3
# virsh start node4</screen>
				</para>
			</listitem>
			<listitem>
				<para>
					Invoke the main oVirt page by running Firefox on the guest.
<screen># ssh -Y root@192.168.50.2 firefox</screen>
					 Enter the root password: <code>ovirt</code>
				</para>
				<para>
					A browser window opens displaying the oVirt User Administration Interface.
				</para>
			</listitem>
			<listitem>
				<para>
					To connect to the console of a virtual machine running on a managed node:
<screen># ssh -Y root@192.168.50.2 virt-viewer -c qemu+tcp://node3.priv.ovirt.org/system VM_NAME</screen>
				</para>
			</listitem>
		</orderedlist>
		<note>
			<title>Note</title>
			<para>
				The kickstart can be copied to a local webserver and modified so that the repos referenced in the kickstart point to local mirrors. In this case, the command is:
<screen>
# create-wui-appliance.sh -t http://foo/f9-x86_64 -k http://foo/wui-rel-x86_64.ks -b</screen>
			</para>
		</note>
	</section>

	<section id="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-About_create_wui_appliance.sh">
		<title>About create-wui-appliance.sh</title>
		<para>
			create-wui-appliance is the pre-built appliance that is available from the oVirt website download page. Use this appliance to install either version of oVirt.
		</para>
		<para>
			If you have not already done so, you can download the <ulink url="http://ovirt.org/download/ovirt-developer-appliance-0.91-1-x86_64.tar"> appliance</ulink> onto the host machine, and follow the instructions in either <xref linkend="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_oVirt_Appliance" /> or <xref linkend="sect-oVirt_Installation_Guide-Stand_alone_oVirt_Applicance_installation-Installing_oVirt_on_a_Physical_Network" /> to install the appliance.
		</para>
		<table id="tabl-oVirt_Installation_Guide-About_create_wui_appliance.sh-create_wui_appliance.sh_Parameters">
			<title>create-wui-appliance.sh Parameters</title>
			<tgroup cols="1">
				<thead>
					<row>
						<entry>
							<para>
								Usage
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								<command>create-wui-appliance.sh -i install_iso | -t install_tree [-d image_dir] [-a x86_64|i686] </command>
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Parameter
							</para>
						</entry>
						<entry>
							<para>
								Description
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							-i
						</entry>
						<entry>
							Location of installation ISO (required if -t not present)
						</entry>
					</row>
					<row>
						<entry>
							-t
						</entry>
						<entry>
							Location of installation tree (required if -i not present)
						</entry>
					</row>
					<row>
						<entry>
							-k
						</entry>
						<entry>
							URL of kickstart file for use with installation tree
						</entry>
					</row>
					<row>
						<entry>
							-d
						</entry>
						<entry>
							Directory to place virtual disk (default: /var/lib/libvirt/images)
						</entry>
					</row>
					<row>
						<entry>
							-a
						</entry>
						<entry>
							Architecture for the virtual machine (default: x86_64)
						</entry>
					</row>
					<row>
						<entry>
							-v
						</entry>
						<entry>
							Install in developer mode
						</entry>
					</row>
					<row>
						<entry>
							-b
						</entry>
						<entry>
							Install in bundled mode
						</entry>
					</row>
					<row>
						<entry>
							-h
						</entry>
						<entry>
							Display this help and exit
						</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
	</section>

</chapter>

