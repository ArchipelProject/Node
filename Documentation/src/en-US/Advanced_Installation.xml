<?xml version='1.0'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>

<chapter id="chap-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics">
	<title>oVirt Server Suite advanced installation topics</title>
	<para>
		This chapter covers the step by step installation procedure for installing the oVirt Appliance for production environments with separate services for databases, PXE booting and networking. This type of installation allows administrators to build more robust oVirt Server Suite installations. Installation procedure for installing the oVirt Appliance for production environments with separate services for databases, PXE booting and networking. This type of installation allows administrators to build more robust and flexible oVirt Server Suite deployments. Configuring the individual services and applications required by oVirt is described in <xref linkend="chap-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics" />. Links to particular sections will be provided throughout this chapter. description - what it is and why how to set up the component - could be just links to other documentation or ports of existing documentation what oVirt needs from the component - if the component is set up what does oVirt need from it
	</para>
	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-FreeIPA">
		<title>FreeIPA</title>
		<para>
			This section covers integrating Ovirt with FreeIPA
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-PostgreSQL">
		<title>PostgreSQL</title>
		<para>
			This section covers integrating oVirt with the <application>PostgreSQL</application> Relational Database. PostgreSQL is the default Relational Database used with the oVirt Server Suite. PostgreSQL is a powerful, widely used and tested, open source Relational Database.
		</para>
		<para>
			The oVirt Server Suite only supports PostgreSQL as the database at this time.
		</para>
		<para>
			<xref linkend="proc-oVirt_Installation_Guide-PostgreSQL-Preparing_PostgreSQL_for_oVirt" /> details preparing a postgres database for the oVirt Appliance. Complete this procedure <emphasis>before</emphasis> installing oVirt if you require a network connected database on a separate server. The oVirt Server Suite requires PostgreSQL version 8.2 or higher. Version 8.2 is recommended.
		</para>
		<procedure id="proc-oVirt_Installation_Guide-PostgreSQL-Preparing_PostgreSQL_for_oVirt">
			<title>Preparing PostgreSQL for oVirt</title>
			<step>
				<para>
					Install PostgreSQL and the ruby connector and server packages:
<screen>$ sudo yum install ruby-postgres postgresql-server</screen>
				</para>
			</step>
			<step>
				<para>
					The database must be initialized before you can create tables. If the Postgres database is already initialized skip this step.
<screen>$ sudo /sbin/service postgresql initdb</screen>
				</para>
			</step>
			<step>
				<para>
					Start the service.
<screen>$ sudo /sbin/service postgresql start</screen>
				</para>
			</step>
			<step>
				<para>
					It is recommended to add the database to the boot sequence as well. Use the chkconfig command to add <application>postgres</application> to the <application>initscripts</application>. <replaceable>35</replaceable> in the example specifies which run levels should start the application, modify this number to set postgres to start on your servers default run level.
<screen>sudo /sbin/chkconfig --level <replaceable>35</replaceable> postgres on</screen>
				</para>
			</step>
			<step>
				<para>
					Change to the <systemitem class="username">postgres</systemitem> user to add the oVirt tables.
<screen>$ sudo su - postgres</screen>
				</para>
			</step>
			<step>
				<para>
					In the postgres shell, create a new database for the oVirt Server Suite and open that database.
<screen>$ createdb ovirt
$ psql ovirt</screen>
				</para>
			</step>
			<step>
				<para>
					Create a user, <systemitem class="username">ovirt</systemitem>, replacing <replaceable>password</replaceable> with a strong password. Then create tables for <systemitem class="resource">ovirt</systemitem> and <systemitem class="resource">ovirt_test</systemitem> with privileges for the user <systemitem class="username">ovirt</systemitem>. Exit after creating the tables.
<programlisting>$-# CREATE USER ovirt WITH PASSWORD &#39;<replaceable>password</replaceable>&#39;;
$-# CREATE DATABASE ovirt;
$-# GRANT ALL PRIVILEGES ON DATABASE ovirt to ovirt;
$-# CREATE DATABASE ovirt_test;
$-# GRANT ALL PRIVILEGES ON DATABASE ovirt_test to ovirt;
$-# \q
$ exit</programlisting>
				</para>
			</step>
			<step>
				<para>
					Enable client authentication for networked connections. Open <filename>/var/lib/pgsql/data/pg_hba.conf</filename> and append the line in the example, replacing the IP addresses with valid IP addresses for systems which will have the oVirt Server Suite installed.
<programlisting>host all all <replaceable>10.0.0.1</replaceable> trust</programlisting>
				</para>
			</step>
			<step>
				<para>
					Enable TCP/IP connections to your postgres database by editing the PostgreSQL configuration file <filename>/var/lib/pgsql/data/postgresql.conf</filename> on the system containing the oVirt database. Locate the line "<computeroutput>listen_addresses=&#39;localhost&#39;</computeroutput>". Replace the <systemitem class="etheraddress">localhost</systemitem> address with a list of valid addresses of oVirt servers. For example if oVirt Server Suite was installed on <systemitem class="etheraddress">10.0.0.1</systemitem> and <systemitem class="etheraddress">10.0.0.2</systemitem> then the modified entry would be <computeroutput>listen_addresses=&#39;<replaceable>10.0.0.1 10.0.0.2</replaceable>&#39;</computeroutput>. Specifying which IP address clients can connect to the database is considered a good security precaution.
				</para>
			</step>
			<step>
				<para>
					Verify the connection is open to external Postgres connections on the specified addresses.
				</para>
			</step>
			<step>
				<para>
					Restart the PostgreSQL service and continue with other advanced installation topic or commence the installation.
<screen>$ sudo /sbin/service postgres restart
Stopping postgresql service:                               [  OK  ]
Starting postgresql service:                               [  OK  ]</screen>
				</para>
			</step>
		</procedure>
<formalpara><title>Configuring the oVirt Appliance the PostgreSQL database</title><para>TBD</para></formalpara>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-Other_Relational_Database_systems">
		<title>Other Relational Database systems</title>
		<para>
			This section covers integrating oVirt with other relational databases.
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-Network_service_configuration_DNS_and_DHCP">
		<title>Network service configuration - DNS and DHCP</title>
		<para>
			This section covers integrating oVirt with existing <systemitem class="service">DNS</systemitem> and <systemitem class="service">DHCP</systemitem> services.
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-PXE">
		<title>PXE</title>
		<para>
			The Preboot Execution Environment(PXE) is an environment for booting computers using only a network interface independent of local storage.
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-Advanced_PXE_with_Cobbler">
		<title>Advanced PXE with Cobbler</title>
		<para>
			This section covers integrating oVirt with <application>Cobbler</application> and <systemitem class="service">tftpd</systemitem> for advanced network management and deployment of managed nodes.
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-GFS">
		<title>GFS</title>
		<para>
			This section covers integrating oVirt with <application>Cobbler</application> and <systemitem class="service">tftpd</systemitem> for advanced network management and deployment of managed nodes.
		</para>
	</section>

	<section id="sect-oVirt_Installation_Guide-oVirt_Server_Suite_advanced_installation_topics-oVirt_Server_Suite_advanced_installation">
		<title>oVirt Server Suite advanced installation</title>
		<para>
			After all the services are configured, install.
		</para>
	</section>

</chapter>

